<HTML>
	<head>
		<TITLE>SmashingTheStack.org!</TITLE>
		<meta name="description" content="OpenSource software and other stuff for all your hacky needs!">
		<meta name="keywords" content="programming, hacking, screencasting, random stuff, security, software">
		<style type="text/css">ol{margin:0;padding:0}p{margin:0}.c2{color:#ff0000;text-decoration:underline;font-weight:bold}.c7{text-decoration:underline;font-weight:bold}.c4{color:inherit;text-decoration:inherit}.c0{height:11pt;direction:ltr}.c6{color:#000099;text-decoration:underline}.c3{color:#ff0000}.c1{direction:ltr}body{color:#000000;font-size:11pt;font-family:Arial}h1{padding-top:24pt;color:#000000;font-size:24pt;font-family:Arial;font-weight:bold;padding-bottom:6pt}h2{padding-top:18pt;color:#000000;font-size:18pt;font-family:Arial;font-weight:bold;padding-bottom:4pt}h3{padding-top:14pt;color:#000000;font-size:14pt;font-family:Arial;font-weight:bold;padding-bottom:4pt}h4{padding-top:12pt;color:#000000;font-size:12pt;font-family:Arial;font-weight:bold;padding-bottom:2pt}h5{padding-top:11pt;color:#000000;font-size:11pt;font-family:Arial;font-weight:bold;padding-bottom:2pt}h6{padding-top:10pt;color:#000000;font-size:10pt;font-family:Arial;font-weight:bold;padding-bottom:2pt}</style>
	</head>
		<BODY BACKGROUND="/shared/images/background.jpg" BGCOLOR="#fefefe" TEXT="#000000" LINK="#000000" VLINK="#000000" ALINK="#000000">
			<CENTER>
				<TABLE BORDER="0" WIDTH="85%" CELLSPACING="0" CELLPADDING="0">
					<TR>
						<TD COLSPAN="3">
							<TABLE WIDTH="95%" CELLSPACING="0" CELLPADDING="0">
								<TR>
									<TD ALIGN="center" VALIGN="bottom" WIDTH="55%">
										<TABLE WIDTH="80%" CELLPADDING="0">
											<TR>
												<TD BGCOLOR="#000000">
													<TABLE WIDTH="100%" CELLPADDING="6">
														<TR>
															<TD BGCOLOR="#fefefe">
																<CENTER><B>Tutorials - Security</B></CENTER>
															</TD>
														</TR>
													</TABLE>
												</TD>
											</TR>
										</TABLE>
									</TD>
									<TD VALIGN="bottom" ALIGN="right">
										<TABLE CELLPADDING="0">
											<TR>
												<TD BGCOLOR="##000000">
													<TABLE CELLPADDING="0">
														<TR>
															<!-- Upper right corner, site logo? -->
															<!-- <TD BGCOLOR="#ffffff">
																<A HREF="/index.html"><IMG SRC="/grfx/shared/slackware1337.gif" ALT="Slackware Logo" BORDER="0"></A>
																
															</TD> -->
														</TR>
													</TABLE>
												</TD>
											</TR>
										</TABLE>
									</TD>
								</TR>
								<TR>
									<TD COLSPAN="2">
										<BR>
									</TD>
								</TR>
							</TABLE>
						</TD>
					</TR>
					<TR VALIGN="top">
						<TD WIDTH="10%">
							<TABLE WIDTH="100%" CELLPADDING="0">
								<TR>
									<TD BGCOLOR="#000000">
										<!-- SideBar -->
										<TABLE WIDTH="100%" CELLPADDING="0">
											<TR>
												<TD BGCOLOR="#000000">
													<TABLE WIDTH="100%" CELLPADDING="14">
														<TR>
															<TD BGCOLOR="#fefefe">
																<FONT SIZE="-1">
																	<B><A HREF="/index.html">News</A><P></B>
																	<A HREF="/whoami.html"># whoami</A><P>
																</FONT>
															</TD>
														</TR>
													</TABLE>
												</TD>
											</TR>
										</TABLE>
										
										
										<TABLE WIDTH="100%" CELLPADDING="14">
											<TR>
												<TD BGCOLOR="#fefefe">
													<FONT SIZE="-1"><B>
														<A HREF="/tutorials/">Tutorials</A><P></b>
														<li><a href="/tutorials/programming/">Programming</a><br>
														<li><a href="/tutorials/networking/">Networking</a><br>
														<!-- <a href="hacking/">Grey Hat Hacking</a> -->
														<!-- Good! You can think! :D -->
														<li><a href="/tutorials/moron.html">Gray Hat Hacking</a><br>
														<li><a href="/tutorials/hardware/">Hardware Hacking</a><br>
														<b><li><a href="/tutorials/security/">Security</a></b>
													</FONT>
												</TD>
											</TR>
										</TABLE>
									</TD>
								</TR>
							</TABLE>
														
							<TABLE WIDTH="100%" CELLPADDING="0">
								<TR>
									<TD BGCOLOR="#000000">
										<!-- SideBar -->
										<TABLE WIDTH="100%" CELLPADDING="14">
											<TR>
												<TD BGCOLOR="#fefefe">
													<FONT SIZE="-1"><B>
														<A HREF="/coding/">Code</A><P>
														<A HREF="/essays/">Essays</A><P>
														<A HREF="/tools.html">Tools</A><P>
														<A HREF="/links.html">Links</A><P>
														<A HREF="/reading.html">Books and Papers</A><P>
														<A HREF="/contact.html">Contact</A></B>
													</FONT>
												</TD>
											</TR>
										</TABLE>
									</TD>
								</TR>
							</TABLE>
							
							<P>	
						</TD>
						<TD> &nbsp; </TD>
						<TD>
						
						<!-- News starts here -->
							<CENTER>					
								<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLPADDING="0">
									<TR>
										<TD COLSPAN="2">
											<TABLE WIDTH="100%" CELLPADDING="0">
												<TR>
													<TD BGCOLOR="#000000">
														<TABLE WIDTH="100%" CELLPADDING="4">
															<TR>
																<TD BGCOLOR="#fefefe">
																	&nbsp;<B> Multiplatform USB Drive Filesystem encryption<B>
																</TD>
															</TR>
														</TABLE>
													</TD>
												</TR>
											</TABLE>
										</TD>
									</TR>
									<TR>
										<TD VALIGN="top">
											<TABLE WIDTH="100%" CELLPADDING="0">
												<TR>
													<TD BGCOLOR="#000000">
														<TABLE WIDTH="100%" CELLPADDING="14">
															<TR>
																<TD BGCOLOR="#fefefe">
																	<p class="c1"><span>Encryption... such a hyped up word for what it really is. I won&rsquo;t deny how useful it is but everyone thinks encryption will save the day and make the best security. It won&rsquo;t. But it will help preventing people who know nothing of cryptanalysis from reading your emails or damaging your system... and if you use the right encryption with a good passphrase, it could also prevent government agencies with advance cryptanalysis technologies to get your data. I kinda like that idea.</span></p><p class="c0"><span></span></p><p class="c1"><span>This tutorial will show how to use TrueCrypt to encrypt a USB drive on the fly. You can also apply this knowledge to encrypt your harddrives but I wouldn&rsquo;t recommend to use this software but something like a EncFS for linux or EFS for Windows. However I was looking for a multi-platform filesystem encryption for the USB key I use for university and I found this which does the trick.</span></p><p class="c0"><span></span></p><p class="c1"><span>It has a graphical front end but you can go through the CLI and do everything manually there, for simplicities sake I will guide you through the GUI and explain every step of the process and what the cryptography gibberish means.</span></p><p class="c0"><span></span></p><p class="c1"><span>For starters, go download TrueCrypt for your platform and install it. Unfortunately this is not considered &lsquo;open-source&rsquo; from the Open Source Initiative even though the code itself is open to the public... don&rsquo;t ask, just some good old fashioned open-source bureaucracy. You can find TrueCrypt </span><span class="c6"><a class="c4" href="http://www.truecrypt.org/downloads">here</a></span><span>.</span></p><p class="c0"><span></span></p><p class="c1"><span>Once it&rsquo;s installed (I&rsquo;m assuming you know how to install software), insert an </span><span class="c7">EMPTY</span><span>&nbsp;USB flash drive...</span><span class="c3">&nbsp;EMPTY. YOU DON&rsquo;T WANT ANY OF YOUR FILES ON THIS DISK SO MAKE A BACKUP IF YOU&rsquo;RE PLANNING ON DOING THIS ON A KEY YOU USE REGULARLY, PERFORMING MY TUTORIAL WILL </span><span class="c2">WIPE CLEAN</span><span class="c3">&nbsp;YOUR USB DRIVE. </span><span>Yes, you can image me yelling at you the previous sentence. Now that the large capital letter warning has been issued; insert your USB key (In my case I&rsquo;m using a 16 gig Sandisk Cruzer) and double click on the TrueCrypt icon and you will be presented with the below screen:</span></p><p class="c0"><span></span></p><p class="c1"><img height="483" src="images/image03.jpg" width="569"></p><p class="c0"><span></span></p><p class="c1"><span>Please ignore the list of drive letters and click on the &ldquo;create volume&rdquo; button in the middle left of the screen. </span></p><p class="c0"><span></span></p><p class="c0"><span></span></p><p class="c1"><img height="365" src="images/image00.jpg" width="606"></p><p class="c0"><span></span></p><p class="c1"><span>There are a few options here. The TrueCrypt documentation say that newbies (i.e. you the reader) should use the &ldquo;Create an ecnrypted file container&rdquo;. I don&rsquo;t like that so I chose the &ldquo;Encrypt a non-system partition/drive&rdquo;.</span></p><p class="c0"><span></span></p><p class="c1"><span>Let me explain: What we&rsquo;re about to do is to encrypt a filesystem. A filesystem if you don&rsquo;t know is a method of organizing data in a human readable format. So when you double click on your drive letter (lets take C:\ for example) the computer reads that database tables and shows it to the user. The filesystem will also determine HOW the computer will access these files (typically via an index). There&rsquo;s quite a lot more info on this but you don&rsquo;t really need much more knowledge on this to encrypt your disk drive. </span></p><p class="c0"><span></span></p><p class="c1"><span>What the first option does is not encrypting the actual filesystem but creating a very virtual file system where you store your data in. When you want to read/write the file system, you mount this file instead of the USB key. Now Windows (of course) will still mount the USB key AND mount a separate file system thus using two drive letters instead of one. Which was one of the reasons why I wanted to avoid using the first option. Linux however just saw one drive and mounted it as one drive instead of two... go figure. But anyway, go with the second option and press next.</span></p><p class="c0"><span></span></p><p class="c0"><span></span></p><p class="c0"><span></span></p><p class="c0"><span></span></p><p class="c0"><span></span></p><p class="c1"><img height="365" src="images/image07.jpg" width="606"></p><p class="c0"><span></span></p><p class="c1"><span>Press the &ldquo;select drive&rdquo; button.</span></p><p class="c0"><span></span></p><p class="c1"><img height="364" src="images/image06.jpg" width="464"></p><p class="c0"><span></span></p><p class="c1"><span>Here is where you want to select your drive. Now the TrueCrypt software actually seems bugged as it is also showing my C:\ &hellip;. which you really do not want to encrypt. That would be bad... but nonetheless, select your USB drive and press Ok and then &ldquo;next&rdquo;.</span></p><p class="c0"><span></span></p><p class="c0"><span></span></p><p class="c1"><img height="365" src="images/image01.jpg" width="606"></p><p class="c0"><span></span></p><p class="c1"><span>Now since I told you to make a backup of your drive, keep the default option selected (Created encrypted volume and format it) and press Next. The reason why I told you to do that and not select the second option and encrypt your files with the drive is when TrueCrypt will format the drive, it will write random data all over the disk so like that if someone does a filesystem dump, i.e. if someone is reading the raw data off the drive, he won&rsquo;t be able to pinpoint where files are stored. Some of you might be scratching your head at that last statement. When a system formats a disk drive or partition, it will write a bunch of null bytes (binary 0) to the data sections of the partition. So if you would dump a usb key&rsquo;s file system, you would see the header segments (which the database table will point to) and then &nbsp;bunch of zeroes until it meets data that has been written. So what TrueCrypt (and every other filesystem encryption methods) will do is write random data in those places so that you can&rsquo;t easily tell where data is stored. Anyway, press next.</span></p><p class="c0"><span></span></p><p class="c0"><span></span></p><p class="c1"><img height="365" src="images/image02.jpg" width="606"></p><p class="c0"><span></span></p><p class="c1"><span>Here is the fun part. Choosing the encryption and hash algorithm. Now there are various reason as to choose one or another. Here I chose to use Twofish because I&rsquo;m a big fan of the fish family of encryption methods (blowfish, threefish etc) and it provides an almost equal encryption and decryption speed. AES is also a very good choice but is slightly slower in the encryption speed then two fish. If that doesn&rsquo;t make sense, substitute the words &ldquo;encryption speed&rdquo; for &ldquo;write speed&rdquo; and &ldquo;decryption speed&rdquo; for &ldquo;read speed&rdquo;. You can also combine AES and twofish which offers a double encyrption but it will severely impact performance. Choose whatever you want, but I can say for general purpose, Twofish is excellent and AES follows up. </span></p><p class="c0"><span></span></p><p class="c1"><span>Fun fact: AES is what the American Government uses to encrypt their top secret files.</span></p><p class="c0"><span></span></p><p class="c1"><span>Then the hash algorithm. I chose SHA-512 as I&rsquo;m a big fan of the SHA series... and also because I don&rsquo;t know the other two too well. What this will do is it will encrypt your password and store it in the filesystem. You may be asking: &ldquo;Wait! what?! Store MY password in the USB drive&rdquo;. Yes. Because when you type your password, it needs to be able to compare your password with something. So it will take your plaintext password, hash it and compare the values with what it has. So no worries, your password is not stored in plaintext. Once you made your selection, press next.</span></p><p class="c0"><span></span></p><p class="c0"><span></span></p><p class="c0"><span></span></p><p class="c1"><img height="365" src="images/image05.jpg" width="606"></p><p class="c0"><span></span></p><p class="c1"><span>Press next again.</span></p><p class="c0"><span></span></p><p class="c1"><img height="365" src="images/image09.jpg" width="606"></p><p class="c0"><span></span></p><p class="c1"><span>And now to choose a password. You see what the TrueCrypt developers wrote? Read it carefully. Okay, now read it again. Does it make sense? Because if you choose your password as &ldquo;password&rdquo; and someone tries to bruteforce your USB drive, don&rsquo;t come complaining to me that what I told you in the first paragraph was a lie, because I will seriously punch you in the face. Choose a good password. Want an example of a good password, here&rsquo;s one:</span></p><p class="c0"><span></span></p><p class="c1"><span>T|-|15I5@G00dPa55\/\/0|&lt;D</span></p><p class="c0"><span></span></p><p class="c1"><span>See that? yeah. 25 characters, Alphanumeric, Symbols and both lower and upper case characters. Can you make sense of it? If you look carefully it writes out: ThisIsAGoodPassword. If you don&rsquo;t know how to choose a good password, go find an online tutorial. Nuff&rsquo; Said. Press next once you typed your password (and for the sake of security, don&rsquo;t check the &ldquo;Display password&rsquo; checkbox if you&rsquo;re in an public area... or even at home, never know who is watching).</span></p><p class="c0"><span></span></p><p class="c0"><span></span></p><p class="c0"><span></span></p><p class="c1"><img height="365" src="images/image04.jpg" width="606"></p><p class="c0"><span></span></p><p class="c1"><span>Okay, this part is up to you. I chose yes for this because I might be carrying some ISO disk images or very large archives around and they can take more than 4 gigs. But if you intend to only to carry small files, I would suggest to select the no option as it will improve read/write performance. Press next.</span></p><p class="c0"><span></span></p><p class="c1"><img height="365" src="images/image08.jpg" width="605"></p><p class="c0"><span></span></p><p class="c1"><span>You&rsquo;re almost done! Keep the default filesystem and cluster values and start randomly waving your mouse around in the TrueCrypt window for a minute or so. TrueCrypt will gather some random data based off the pointer position for it&rsquo;s encryption algorithm, so the longer you wave your mouse randomly, the better. After that you&rsquo;re done looking like a moron, press the &ldquo;start&rdquo; button and let TrueCrypt do it&rsquo;s job.</span></p><p class="c0"><span></span></p><p class="c1"><span>Once that&rsquo;s done. You will be presented with the first screen and all you have to do is press the &ldquo;Auto-mount Devices&rdquo; button, enter your password, and you&rsquo;re good to go!</span></p>
																</TD>
															</TR>
														</TABLE>
													</TD>
												</TR>
											</TABLE>
										</TD>
									</TR>
									<TR>
										<TD COLSPAN="2">
											<BR>
										</TD>
									</TR>
								</TABLE>
								
								<CENTER>
									<a href="http://www.linuxfoundation.org/20th" target="_blank"><img src="http://www.linuxfoundation.org/20th/images/lf_linux20_webbadge.png"	width="300" height="250" alt="I'll be celebrating 20 years of Linux with The Linux Foundation!" border="0"></a>
								</CENTER>
								
								<TR>
									<TD COLSPAN="2">
										<BR>
									</TD>
								</TR>
						</TD>
					</TR>
				</TABLE>
		</CENTER>
</HTML>